---
title: '세마포어 (Semaphore): "N명까지는 괜찮아! 3칸짜리 화장실의 열쇠 꾸러미"'
date: 2025-09-17
updated: 2025-09-17
tags:
published: false
aliases: []
---
# 세마포어 (Semaphore): "N명까지는 괜찮아! 3칸짜리 화장실의 열쇠 꾸러미"
>[[250917-Solution-of-Race-Condition|경쟁 상태]]를 해결하기 위한 솔루션 중 하나

- **이름의 유래**: 기찻길에서 사용하는 '신호기'라는 뜻입니다. "자리가 비었으니 들어와도 좋다/안 좋다"를 알려주는 신호기 역할을 합니다.
- **비유**: 이번에는 똑같은 칸이 3개 있는 **3인용 공중화장실**입니다. 입구에는 **열쇠가 3개**가 걸려있는 '열쇠 꾸러미'가 있습니다. 이 열쇠 꾸러미가 바로 세마포어입니다.
    
    1. **Wait (또는 P 연산)**: A라는 사람이 와서 열쇠 꾸러미를 봅니다. 열쇠가 2개 남아있네요. 그중 하나를 가지고 들어갑니다. (남은 열쇠: 1개)
    2. B와 C도 와서 남은 열쇠를 하나씩 가져갑니다. (남은 열쇠: 0개)
    3. **대기 (Wait)**: D라는 사람이 왔는데, 열쇠가 하나도 없습니다. D는 누군가 열쇠를 반납할 때까지 기다려야 합니다.
    4. **Signal (또는 V 연산)**: A가 볼일을 다 보고 나오면서 열쇠를 꾸러미에 다시 걸어둡니다. (남은 열쇠: 1개)
    5. **획득 (Acquire)**: 기다리던 D가 새로 생긴 열쇠를 보고, 가져가서 화장실에 들어갑니다.
        
- **핵심 특징**: 세마포어는 **정해진 개수(N)만큼**의 스레드가 공유 자원에 동시에 접근하는 것을 허용합니다. 사용 가능한 자원의 개수를 **카운팅**하는 정수 변수(카운팅 세마포어)를 가집니다.

[[250917-Mutex|싱글스레드를 위한 방식도 있음]]